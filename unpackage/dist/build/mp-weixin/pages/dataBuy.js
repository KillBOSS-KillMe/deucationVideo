(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/dataBuy"],{"0444":function(t,e,a){"use strict";var s=a("a617"),i=a.n(s);i.a},"2ee3":function(t,e,a){"use strict";var s,i=function(){var t=this,e=t.$createElement;t._self._c},n=[];a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return s}))},6657:function(t,e,a){"use strict";a.r(e);var s=a("d79f"),i=a.n(s);for(var n in s)"default"!==n&&function(t){a.d(e,t,(function(){return s[t]}))}(n);e["default"]=i.a},9369:function(t,e,a){"use strict";a.r(e);var s=a("2ee3"),i=a("6657");for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("0444");var o,r=a("f0c5"),u=Object(r["a"])(i["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],o);e["default"]=u.exports},a617:function(t,e,a){},ca92:function(t,e,a){"use strict";(function(t){a("95ab"),a("921b");s(a("66fd"));var e=s(a("9369"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},d79f:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=getApp(),s={data:function(){return{info:{},imgUrl:"",dataType:"",usePoints:"",addressList:{},is_use:"2"}},onShow:function(){var e=t.getStorageSync("address")||[];this.addressList=e},onLoad:function(e){this.imgUrl=this.$helper.imgUrl,this.shopId=e.id,"courseBuy"==e.type?(this.dataType="curricula",this.title="课程购买"):"books"==e.type?(this.dataType="book",this.title="图书购买"):"datas"==e.type&&(this.dataType="data",this.title="资料购买"),this.type=e.type,t.setNavigationBarTitle({title:this.title}),this.getShop(),this.submintOrder=this.$helper.debounce(this.submintPay,1500)},methods:{getShop:function(){var e=this;t.showLoading({title:"加载中..."}),t.request({url:"".concat(this.$helper.requestUrl,"pay/calculationPrice"),method:"POST",header:{authorization:a.globalData.token},data:{type:this.dataType,id:this.shopId},success:function(a){t.hideLoading(),a=e.$helper.null2str(a.data),"ok"==a.status_code?(e.info=a.data,e.usePoints=a.data.use_integral):t.showToast({title:a.data.message,icon:"none"})}})},checkboxChange:function(t){var e=t.detail.value;console.log(e),1==e?(this.usePoints=0,this.is_use=1):(this.usePoints=1,this.is_use=2)},goAdderss:function(){t.navigateTo({url:"/pages/addersList"})},addAddress:function(){t.navigateTo({url:"/pages/addersList"})},submintPay:function(){var e=this,s="";s=1==this.info.type?this.addressList.id:"",t.request({url:"".concat(this.$helper.requestUrl,"pay/placeOrder"),method:"POST",header:{authorization:a.globalData.token},data:{type:this.dataType,id:this.shopId,is_use:this.is_use,address_id:s},success:function(a){a=e.$helper.null2str(a.data),console.log(a,"下单信息"),t.hideToast(),"ok"==a.status_code?e.goBuy(a.data):t.showToast({title:a.message,icon:"none"})}})},goBuy:function(e){var s=this;t.request({url:"".concat(this.$helper.requestUrl,"pay/pay"),method:"POST",header:{authorization:a.globalData.token},data:{type:this.dataType,ordernum:e},success:function(e){e=s.$helper.null2str(e.data),console.log(e,"-------------------"),t.hideToast(),"ok"==e.status_code?s.getPay(e.data):t.showToast({title:e.message,icon:"none"})}})},getPay:function(e){var a=this;t.showLoading({title:"支付加载中..."}),t.requestPayment({provider:"wxpay",timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(e){t.hideLoading(),e=a.$helper.null2str(e),console.log(e),t.showToast({title:"支付成功",icon:"success",duration:2e3}),setTimeout((function(e){"课程购买"==a.title?t.redirectTo({url:"/pages/courseOrder"}):"图书购买"==a.title?t.redirectTo({url:"/pages/dataOrder?type=图书订单"}):"资料购买"==a.title&&t.redirectTo({url:"/pages/dataOrder?type=资料订单"})}),2e3)},fail:function(e){t.showToast({title:"支付失败",icon:"none",duration:2e3})}})}}};e.default=s}).call(this,a("543d")["default"])}},[["ca92","common/runtime","common/vendor"]]]);