(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/findDetail"],{"1c77":function(t,e,i){"use strict";i.r(e);var o=i("e31c"),a=i("b3f4");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("fa82");var n,d=i("f0c5"),u=Object(d["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],n);e["default"]=u.exports},6803:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(i("3776")),a=s(i("f5fd"));function s(t){return t&&t.__esModule?t:{default:t}}var n=!1,d=getApp(),u={mixins:[a.default],data:function(){return{isShow:!0,is_like:0,findId:"",shadeList:[],videoList:{},time:0,show_play:!1,shade:!1,imgUrl:"",totalPage:"",page:"1",text:"",postContent:"",userInfoButtonShow:!0,likeNum:"",isShowBox:""}},onLoad:function(e){var i=this;this.imgUrl=this.$helper.imgUrl,this.findId=e.id,this.getVideo(),t.getSetting({success:function(t){t.authSetting["scope.userInfo"]&&(i.userInfoButtonShow=!1)}}),t.request({url:"".concat(o.default.requestUrl,"discover/hide"),method:"GET",success:function(t){t=o.default.null2str(t.data),"ok"==t.status_code&&(console.log(t.data),i.isShowBox=t.data)}})},onShareAppMessage:function(e){var i=this;return t.request({url:"".concat(o.default.requestUrl,"discover/sharePlus"),method:"POST",data:{discover_id:this.findId},success:function(a){e=o.default.null2str(e),t.hideToast(),200===a.statusCode&&i.videoList.share++}}),{title:this.videoList.title,path:"/pages/findDetail?id=".concat(this.findId)}},methods:{clickVideo:function(){this.videoPlay()},verificationUserInfo:function(){if(!this.userInfo.hasOwnProperty("id"))return t.showToast({title:"用户信息加载中...",icon:"none"}),!0},onGetUserInfo:function(e){var i=this;if("getUserInfo:ok"==e.detail.errMsg){var a=e.detail.userInfo;t.login({success:function(e){t.request({url:"".concat(o.default.requestUrl,"auth/login"),method:"POST",data:{code:e.code,nickname:a.nickName,sex:a.gender,headimgurl:a.avatarUrl,mobile:""},success:function(a){if(e=o.default.null2str(e),t.hideToast(),200===a.statusCode){i.userInfoButtonShow=!1;var s=a.data.token_type+" "+a.data.access_token;d.globalData.token=s,i.getIndexInfo(),i.getVideo()}else t.showModal({title:"",content:a.data.errmsg})}})}})}},getIndexInfo:function(){var e=this;t.request({url:"".concat(o.default.requestUrl,"auth/me"),method:"POST",header:{authorization:d.globalData.token},success:function(i){t.hideLoading(),i=o.default.null2str(i),"ok"==i.data.status_code&&(e.userInfo=i.data.data,d.globalData.userInfo=i.data.data)}})},videoPlay:function(){this.videoList.id;n?(this.videoCtx=t.createVideoContext("myVideo"),this.videoCtx.play(),this.show_play=!1,n=!1):(this.videoCtx=t.createVideoContext("myVideo"),this.videoCtx.pause(),this.show_play=!0,n=!0)},timeupdate:function(t){var e=parseInt(this.width);this.duration=t.detail.duration,this.time=t.detail.currentTime;this.time,this.duration},getVideo:function(){var e=this;t.showLoading({title:"加载中..."}),t.request({url:"".concat(o.default.requestUrl,"discover/discoverDetails"),method:"POST",header:{authorization:d.globalData.token},data:{discover_id:this.findId},success:function(i){if(t.hideLoading(),i=o.default.null2str(i),"ok"==i.data.status_code)if(e.videoList=i.data.data,e.is_like=i.data.is_like,e.likeNum=e.videoList.like,e.likeNum.toString().length>=4){var a=(e.likeNum/1e4).toFixed(1);e.likeNum=a+"W"}else e.likeNum=e.videoList.like}})},tapShade:function(){this.shadeList=[],this.shade=!0,this.getShade()},getShade:function(){var e=this;t.showLoading({title:"加载中..."}),t.request({url:"".concat(o.default.requestUrl,"discover/commentList"),method:"POST",header:{authorization:d.globalData.token},data:{discover_id:this.findId,page_size:"10",page:this.page},success:function(i){if(t.hideLoading(),i=o.default.null2str(i),"ok"==i.data.status_code){var a=i.data.data.data;e.totalPage=i.data.data.total,e.shadeList=e.shadeList.concat(a)}}})},nextScroll:function(){this.page++,this.getShade()},closeTapShade:function(){this.shade=!1},post:function(t){this.postContent=t.detail.value},send:function(){var e=this;""!=this.postContent?(t.showLoading({title:"发表中..."}),t.request({url:"".concat(o.default.requestUrl,"discover/comment"),method:"POST",header:{authorization:d.globalData.token},data:{discover_id:this.findId,content:this.postContent},success:function(i){i=o.default.null2str(i),t.hideLoading(),"ok"==i.data.status_code?(t.showToast({title:i.data.message,icon:"none"}),e.postContent="",e.page="1",e.shadeList=[],e.getShade()):t.showToast({title:i.data.message,icon:"none"})}})):t.showToast({title:"请输入发表内容",icon:"none"})},tapLike:function(t){var e="";e=0==t?"discover/setLike":"discover/delLike",this.getLike(e)},getLike:function(e){var i=this;t.request({url:"".concat(o.default.requestUrl).concat(e),method:"POST",header:{authorization:d.globalData.token},data:{discover_id:this.findId},success:function(e){if(e=o.default.null2str(e.data),"ok"==e.status_code)if(t.showToast({title:e.message,icon:"none"}),1==i.is_like)if(i.is_like=0,i.videoList.like--,i.videoList.like.toString().length>=4){var a=i.videoList.like;console.log(a),a=(a/1e4).toFixed(1),i.likeNum=a+"W"}else i.likeNum=i.videoList.like;else if(i.videoList.like++,i.is_like=1,i.videoList.like.toString().length>=4){var s=i.videoList.like;console.log(s),s=(s/1e4).toFixed(1),console.log(s),i.likeNum=s+"W"}else i.likeNum=i.videoList.like;else t.showToast({title:e.data.message,icon:"none"})}})}}};e.default=u}).call(this,i("543d")["default"])},b3f4:function(t,e,i){"use strict";i.r(e);var o=i("6803"),a=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);e["default"]=a.a},e31c:function(t,e,i){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},s=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o}))},e857:function(t,e,i){"use strict";(function(t){i("95ab"),i("921b");o(i("66fd"));var e=o(i("1c77"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},eee1:function(t,e,i){},fa82:function(t,e,i){"use strict";var o=i("eee1"),a=i.n(o);a.a}},[["e857","common/runtime","common/vendor"]]]);